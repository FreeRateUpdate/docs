# ADR 2: Testing compatibility between `find_eligible_clients` and replacement API call

## Context

Prior to using the API end point that replaces `find_eligible_clients`
we need to verify it is return results that are identical to the existing
code currently in production. Because we do not have any automated testing
in place, a custom solution will need to be created that can be used
with both systems operating at the same time.

## Decision

Code will added to the existing `find_eligible_clients` method
that would do the following:

* create an empty record in a database table keyed on the ID of the lead
* trigger a worker process
* worker process makes the API call, serializing the result
* serialize the result that `find_eligible_clients` would be returning
* store that result in the same database table

Then another worker will run daily, de-serializing the results and
looking for differences in them.

## Status

Proposed.

## Consequences

* two new workers need to be created, debugged, and added to existing job system
* mechanism for creating a report showing any differences needs to be created
* any parts of `find_eligible_clients` that have side-effects need to be managed during comparison

